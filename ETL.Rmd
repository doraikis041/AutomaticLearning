---
title: "ETL"
author: "Leticia Suarez (202006) - Doris Medina (241578)"
date: "13 de junio de 2019"
output: html_document
---

```{r Inicio, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
```

```{r Librerias}
library(magrittr)
library(plyr)
library(dplyr)
library(tidyverse)
library(modelr)
library(funModeling)
library(ggplot2)
library(ggcorrplot)
library(MASS)
library(GGally)
library(simstudy)
library(foreign)
library(feather)
library(data.table)
library(jtools)
library(purrr)
library(tidyr)
library(XML)
library(xml2)
library(jsonlite)
library(rjson)
library(stringi)
library(here)
library(PCAmixdata)
library(psych)
library(factoextra)
```




```{r Load: geoplaces2.csv }
geoplaces <- read.csv ("Dataset/geoplaces2.csv", sep = ',')
str(geoplaces)
```

Se plotean las coordenadas para identificar si estan visualmente separables
```{r Plot coordenate}
geoCoord <- geoplaces[,1:3]
plot(geoCoord[,2:3])
```

Analizando como se gráfica las coordenadas podemos plantear que los restaurantes estan separado en 3 cuidades diferentes. Visualmente se identificicaron los punto de referencias aproximados y se contrastaron con su ubicación en el mapa para seleccionar los puntos:

*Puntos de Referencia*
22.156925, -100.985634 (San Luis Potosí)
18.924490, -99.221556 (Morelos)
23.732142, -99.148336 (Victoria.Tamaulipas)

```{r Distancia Geo}
library(sp)
#Creando los puntos de referencia
pointLat1 <- matrix(c(22.156925,-100.985634),ncol=2)
pointLat2 <- matrix(c(18.924490,-99.221556),ncol=2)
pointLat3 <- matrix(c(23.732142,-99.148336),ncol=2)

#Convertir a matrix las coordenadas
pointRestaurant <- data.matrix(geoCoord[,2:3])

#Calculando las distancias
distnaciasPointLat1 <- t(spDists(pointLat1, pointRestaurant, longlat = TRUE))
distnaciasPointLat2 <- t(spDists(pointLat2, pointRestaurant, longlat = TRUE))
distnaciasPointLat3 <- t(spDists(pointLat3, pointRestaurant, longlat = TRUE))

#Creando dataframe con todos los resultados
distinacias <- data.frame(placeID=geoplaces$placeID,dist1=distnaciasPointLat1,dist2=distnaciasPointLat2,dist3 = distnaciasPointLat3)

#Obtener el index del valor minimo que representa la ciudad y la distancia para ese valor
for (i in seq(nrow(distinacias))) {
  pCoord <- c(distinacias$dist1[i],distinacias$dist2[i],distinacias$dist3[i])
  distinacias$ciudad[i] <- as.numeric(which.min(pCoord))
  distinacias$minDist[i] <- distinacias[i,as.numeric(which.min(pCoord))+1]
}
head(distinacias)
```

Se alizaron los valores de la columna 
```{r ¿Fumadores?}

```
















```{r}

```

